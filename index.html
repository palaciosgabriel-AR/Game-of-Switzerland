<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Game of Switzerland 2.0</title>
  <style>
    :root { color-scheme: light dark; }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; line-height: 1.5; }
    /* Top bar */
    .topbar { display: flex; align-items: center; justify-content: space-between; padding: .8rem 1rem; border-bottom: 1px solid #e0e0e0; }
    .brand { font-size: clamp(1.2rem, 2vw + .5rem, 1.8rem); display: flex; gap: .35rem; align-items: center; }
    .flag { font-size: 1em; }
    .toggle { display: inline-flex; gap: .5rem; align-items: center; user-select: none; }
    .container { max-width: 900px; margin: 1.2rem auto 3rem; padding: 0 1rem; }
    .status { text-align: center; margin: 0 0 1.25rem; font-weight: 600; }
    .buttons { display: flex; gap: 1rem; justify-content: center; margin-bottom: 1.5rem; flex-wrap: wrap; }
    .btn { padding: .9rem 1.2rem; border: 1px solid #9aa0a6; border-radius: .8rem; background: transparent; cursor: pointer; font-size: 1.2rem; min-width: 4.5rem; }
    .btn:disabled { opacity: .5; cursor: not-allowed; }
    .log h2 { margin: 1rem 0 .5rem; font-size: 1.2rem; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border-bottom: 1px solid #e0e0e0; padding: .55rem .5rem; text-align: left; }
    tbody tr:last-child td { border-bottom: none; }
    /* Dark mode */
    body.dark { background:#0b0c0e; color:#e7e7ea; }
    body.dark .topbar { border-bottom-color: #2a2a2a; }
    body.dark th, body.dark td { border-bottom-color: #2a2a2a; }
    body.dark .btn { border-color: #4b4f56; }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <span class="flag">ðŸ‡¨ðŸ‡­</span>
      <strong>Game of Switzerland 2.0</strong>
      <span class="flag">ðŸ‡¨ðŸ‡­</span>
    </div>
    <label class="toggle">
      <input type="checkbox" id="darkToggle"> Night mode
    </label>
  </header>

  <main class="container">
    <p id="status" class="status"></p>

    <div class="buttons">
      <button id="btn-ae" class="btn">Ã„</button>
      <button id="btn-d"  class="btn">D</button>
      <button id="btn-g"  class="btn">G</button>
    </div>

    <section class="log">
      <h2>Log</h2>
      <table>
        <thead>
          <tr><th>Time</th><th>Button</th><th>Number</th></tr>
        </thead>
        <tbody id="logBody"></tbody>
      </table>
    </section>
  </main>

  <script>
    const TOTAL = 26;
    const used = { 'Ã„': new Set(), 'D': new Set(), 'G': new Set() };

    const statusEl = document.getElementById('status');
    const logBody  = document.getElementById('logBody');
    const darkToggle = document.getElementById('darkToggle');
    const btns = {
      'Ã„': document.getElementById('btn-ae'),
      'D': document.getElementById('btn-d'),
      'G': document.getElementById('btn-g'),
    };

    initDarkMode();
    Object.entries(btns).forEach(([label, el]) => el.addEventListener('click', () => handlePress(label)));
    updateStatus();

    function handlePress(label) {
      const u = used[label];
      const start = rand1toN(TOTAL);
      const n = nextAvailableFrom(start, u);
      const ts = new Date();

      if (n === null) {
        appendLog(ts, label, 'â€”');
        setButtonDisabled(label, true);
        updateStatus();
        return;
      }

      u.add(n);
      appendLog(ts, label, n);
      updateStatus();
      if (u.size === TOTAL) setButtonDisabled(label, true);
    }

    function nextAvailableFrom(start, set) {
      if (set.size >= TOTAL) return null;
      let c = start;
      for (let i = 0; i < TOTAL; i++) {
        if (!set.has(c)) return c;
        c = (c % TOTAL) + 1;
      }
      return null;
    }

    function rand1toN(n) { return Math.floor(Math.random() * n) + 1; }

    function updateStatus() {
      const left = (L) => TOTAL - used[L].size;
      statusEl.textContent = `Numbers left â€” Ã„: ${left('Ã„')}, D: ${left('D')}, G: ${left('G')}`;
    }

    function setButtonDisabled(label, disabled) { btns[label].disabled = disabled; }

    function appendLog(date, label, number) {
      const tr = document.createElement('tr');
      const t = document.createElement('td'); t.textContent = formatTime(date);
      const b = document.createElement('td'); b.textContent = label;
      const n = document.createElement('td'); n.textContent = number;
      tr.append(t, b, n);
      // newest on top
      logBody.firstChild ? logBody.insertBefore(tr, logBody.firstChild) : logBody.appendChild(tr);
    }

    function formatTime(d) {
      const pad = (x) => String(x).padStart(2, '0');
      return `${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
    }

    function initDarkMode() {
      const saved = localStorage.getItem('dark') === '1';
      document.body.classList.toggle('dark', saved);
      darkToggle.checked = saved;
      darkToggle.addEventListener('change', e => {
        document.body.classList.toggle('dark', e.target.checked);
        localStorage.setItem('dark', e.target.checked ? '1' : '0');
      });
    }
  </script>
</body>
</html>
